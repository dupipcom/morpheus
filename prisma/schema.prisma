generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Chart {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  name          String?
  type          String?
  data          Json?
  config        Json?
  visibility    Visibility @default(PRIVATE)
  userId        String    @db.ObjectId
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  profileId     String?   @db.ObjectId
  profile       Profile?  @relation(fields: [profileId], references: [id], onDelete: Cascade)
  noteIds       String[]  @default([]) @db.ObjectId
  documentIds   String[]  @default([]) @db.ObjectId
}

model Comment {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  content       String
  userId        String    @db.ObjectId
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  visibility    Visibility @default(PRIVATE)
  noteId        String?   @db.ObjectId
  note          Note?     @relation(fields: [noteId], references: [id], onDelete: Cascade)
  templateId    String?   @db.ObjectId
  template      Template? @relation(fields: [templateId], references: [id], onDelete: Cascade)
  listId        String?   @db.ObjectId
  list          List? @relation(fields: [listId], references: [id], onDelete: Cascade)
  profileId     String?   @db.ObjectId
  profile       Profile?  @relation(fields: [profileId], references: [id], onDelete: Cascade)
  eventId       String?   @db.ObjectId
  event         Event?    @relation(fields: [eventId], references: [id], onDelete: Cascade)
  likes         Like[]
  noteIds       String[]  @default([]) @db.ObjectId
}

model Day {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  date          String?
  week          Int?
  month         Int?
  quarter       Int?
  semester      Int?
  tasks         Task[]
  mood          Mood?
  ticker        Ticker?
  analysis      Json?
  visibility    Visibility @default(PRIVATE)
  fieldVisibility DayVisibility?
  personIds     String[]  @default([]) @db.ObjectId
  thingIds      String[]  @default([]) @db.ObjectId
  eventIds     String[]  @default([]) @db.ObjectId
  userId       String    @db.ObjectId
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  profileId    String?   @db.ObjectId
  profile      Profile? @relation(fields: [profileId], references: [id], onDelete: Cascade)
  chartIds     String[]  @default([]) @db.ObjectId
  noteIds      String[]  @default([]) @db.ObjectId
  commentIds   String[]  @default([]) @db.ObjectId
  likeIds      String[]  @default([]) @db.ObjectId
}

model Document {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  fileUrl       String
  fileName      String
  fileSize      Float?
  fileFormat    String?
  fileDuration  Float?
  visibility    Visibility @default(PRIVATE)
  owners        String[]  @db.ObjectId
  managers      String[]  @db.ObjectId
  collaborators String[]  @db.ObjectId
  listIds       String[]  @default([]) @db.ObjectId
  templateIds   String[]  @default([]) @db.ObjectId
  noteIds       String[]  @default([]) @db.ObjectId
  thingIds      String[]  @default([]) @db.ObjectId
  eventIds      String[]  @default([]) @db.ObjectId
  personIds     String[]  @default([]) @db.ObjectId
  profileIds    String[]  @default([]) @db.ObjectId
  chartIds      String[]  @default([]) @db.ObjectId
}

model Event {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  name          String
  userId        String    @db.ObjectId
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  quality       Int?
  visibility    Visibility @default(PRIVATE)
  noteIds       String[]  @default([]) @db.ObjectId
  documentIds   String[]  @default([]) @db.ObjectId
  comments      Comment[]
}

model Like {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  entityType    String
  entityId      String    @db.ObjectId
  noteId        String?   @db.ObjectId
  note          Note?     @relation(fields: [noteId], references: [id], onDelete: Cascade)
  templateId    String?   @db.ObjectId
  template      Template? @relation(fields: [templateId], references: [id], onDelete: Cascade)
  commentId     String?   @db.ObjectId
  comment       Comment?  @relation(fields: [commentId], references: [id], onDelete: Cascade)
  userId        String    @db.ObjectId
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  visibility    Visibility @default(PRIVATE)
  
  @@unique([userId, entityType, entityId])
}

model Note {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  content       String
  visibility    NoteVisibility @default(PRIVATE)
  userId        String    @db.ObjectId
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  date          String?
  comments      Comment[]
  likes         Like[]
  personIds      String[]  @default([]) @db.ObjectId
  thingIds       String[]  @default([]) @db.ObjectId
  eventIds       String[]  @default([]) @db.ObjectId
  profileIds     String[]  @default([]) @db.ObjectId
  templateIds    String[]  @default([]) @db.ObjectId
  taskListIds    String[]  @default([]) @db.ObjectId
  documentIds    String[]  @default([]) @db.ObjectId
  chartIds       String[]  @default([]) @db.ObjectId
}

model Person {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  name          String
  userId        String    @db.ObjectId
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  quality Int?
  visibility    Visibility @default(PRIVATE)
  profile       Profile?  @relation(fields: [profileId], references: [id])
  profileId     String?   @unique @db.ObjectId
  noteIds       String[]  @default([]) @db.ObjectId
  documentIds   String[]  @default([]) @db.ObjectId
}

model Profile {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  userId        String    @unique @db.ObjectId
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  visibility    Visibility @default(PUBLIC)
  data          ProfileData?
  personIds     String[]  @default([]) @db.ObjectId
  noteIds       String[]  @default([]) @db.ObjectId
  documentIds   String[]  @default([]) @db.ObjectId
  person        Person?
  comments      Comment[]
  charts        Chart[]
  days          Day[]
}

model List {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  visibility    Visibility @default(PRIVATE)
  role          String?
  name          String?
  budget        Float?
  budgetPercentage Float? @default(0)
  remainingBudget String?
  dueDate       String?
  owners        String[]  @db.ObjectId
  collaborators String[]  @db.ObjectId
  managers      String[]  @db.ObjectId
  publicUrl     String?
  ticker        String?
  progress      String?
  templateId    String?   @db.ObjectId
  template      Template? @relation(fields: [templateId], references: [id])
  templateTasks Task[]
  tasks         Task[]
  ephemeralTasks Json?
  completedTasks Json?
  noteIds       String[]  @default([]) @db.ObjectId
  documentIds   String[]  @default([]) @db.ObjectId
  comments      Comment[]
}

model Template {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  visibility    Visibility @default(PRIVATE)
  role          String?
  name          String?
  owners        String[]  @db.ObjectId
  clonedBy      String[]  @default([]) @db.ObjectId
  tasks         Task[]
  lists         List[]
  comments      Comment[]
  likes         Like[]
  noteIds       String[]  @default([]) @db.ObjectId
  documentIds   String[]  @default([]) @db.ObjectId
}

model Thing {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  name          String
  userId        String    @db.ObjectId
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  quality Int?
  visibility    Visibility @default(PRIVATE)
  noteIds       String[]  @default([]) @db.ObjectId
  documentIds   String[]  @default([]) @db.ObjectId
}

model User {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  entries       Entries?
  settings      Settings?
  analysis      Json?
  availableBalance  Float?
  usedBudget    Float?    @default(0)
  remainingBudget Float?  @default(100)
  profit        Float?    @default(0)
  stash         Float?    @default(0)
  equity        Float?   @default(0)
  totalEarnings Float?   @default(0)
  hint String?
  userId        String?   @unique
  lastLogin     DateTime?
  persons       Person[]
  things        Thing[]
  events        Event[]
  notes         Note[]
  comments      Comment[]
  likes         Like[]
  profile       Profile?
  charts        Chart[]
  days          Day[]
  friends       String[]  @db.ObjectId
  closeFriends  String[]  @db.ObjectId
  friendRequests String[] @db.ObjectId
}

type Completer {
  id String  @db.ObjectId
  earnings Float?
  prize Float?
  time Int
  completedAt DateTime
}

type Currency {
  code CurrencyCode?
  symbol String?
}

type DayVisibility {
  lists Boolean
  mood Boolean
  ticker Boolean
  analysis Boolean
}

type DocumentReference {
  id String
  fileName String
  fileUrl String
}

type Entries {
  data Json?
}

type EventReference {
  id String
  name String
}

type Mood {
  gratitude Int
  optimism Int
  restedness Int
  tolerance Int
  selfEsteem Int
  trust Int
  text String[]
}

type NoteReference {
  id String
  content String
}

type PersonReference {
  id String
  name String
}

type ProfileData {
  username ProfileField?
  firstName ProfileField?
  lastName ProfileField?
  bio ProfileField?
  profilePicture ProfileField?
  charts ProfileField?
}

type ProfileField {
  name String?
  value String?
  visibility Boolean
}

type Settings {
  currency Currency?
  speed Float?
}

type Task {
  id String?

  name String
  categories Category[]
  area Areas
  status String
  cadence String
  times Int?
  count Int?
  localeKey String?
  persons PersonReference[]
  things ThingReference[]
  events EventReference[]
  notes NoteReference[]
  documents DocumentReference[]
  favorite Boolean?
  isEphemeral Boolean?
  createdAt String?
  completedOn String?
  completers Completer[]
  taskStatus String?
  dueDate DateTime?
  budget Float?
  visibility Visibility?
}

type ThingReference {
  id String
  name String
}

type Ticker {
  profit Float?
  prize Float?
}

enum Areas {
  self
  home
  social
  work
}

enum Category {
  body
  spirituality
  fun
  extra
  clean
  affection
  maintenance
  community
  growth
  work
  mind
  spirit
  social
  home
  custom
  event
}

enum CurrencyCode {
  USD
  EUR
  JPY
  GBP
  CNY
  AUD
  CAD
  CHF
  HKD
  BRL
  SEK
  NZD
  MXN
  SGD
  NOK
  KRW
  TRY
  INR
  RUB
  ZAR
  PLN
  CZK
  HUF
  RON
  BGN
  DKK
  ISK
  RSD
  BAM
  MKD
  ALL
  MDL
  UAH
  BYN
  GEL
  AMD
  AZN
}

enum NoteVisibility {
  PRIVATE
  FRIENDS
  CLOSE_FRIENDS
  PUBLIC
  AI_ENABLED
}

enum ProfileVisibility {
  PRIVATE
  FRIENDS
  CLOSE_FRIENDS
  PUBLIC
  AI_ENABLED
}

enum Visibility {
  PUBLIC
  PRIVATE
  FRIENDS
  CLOSE_FRIENDS
  HIDDEN
}
